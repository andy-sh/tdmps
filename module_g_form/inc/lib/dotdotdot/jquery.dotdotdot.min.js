/*	
 *	jQuery dotdotdot 1.6.7
 *	
 *	Copyright (c) 2013 Fred Heusschen
 *	www.frebsite.nl
 *
 *	Plugin website:
 *	dotdotdot.frebsite.nl
 *
 *	Dual licensed under the MIT and GPL licenses.
 *	http://en.wikipedia.org/wiki/MIT_License
 *	http://en.wikipedia.org/wiki/GNU_General_Public_License
 */
!function(t,e){function n(t,e,n){var o=t.children(),r=!1;t.empty();for(var a=0,d=o.length;d>a;a++){var l=o.eq(a);if(t.append(l),n&&t.append(n),i(t,e)){l.remove(),r=!0;break}n&&n.detach()}return r}function o(e,n,a,d,l){var s=e.contents(),u=!1;e.empty();for(var c="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",f=0,h=s.length;h>f&&!u;f++){var p=s[f],g=t(p);"undefined"==typeof p||3==p.nodeType&&0==t.trim(p.data).length||(e.append(g),l&&e[e.is(c)?"after":"append"](l),i(a,d)&&(u=3==p.nodeType?r(g,n,a,d,l):o(g,n,a,d,l),u||(g.remove(),u=!0)),u||l&&l.detach())}return u}function r(e,n,o,r,d){var u=e[0];if(!u)return!1;var f=s(u),h=-1!==f.indexOf(" ")?" ":"　",p="letter"==r.wrap?"":h,g=f.split(p),v=-1,w=-1,y=0,m=g.length-1;for(r.fallbackToLetter&&0==m&&m==y&&(p="",g=f.split(p),m=g.length-1);m>=y&&(0!=y||0!=m);){var b=Math.floor((y+m)/2);if(b==w)break;w=b,l(u,g.slice(0,w+1).join(p)+r.ellipsis),i(o,r)?m=w:(v=w,y=w)}if(-1==v||1==g.length&&0==g[0].length){var x=e.parent();e.remove();var T=d&&d.closest(x).length?d.length:0;x.contents().length>T?u=c(x.contents().eq(-1-T),n):(u=c(x,n,!0),T||x.remove()),u&&(f=a(s(u),r),l(u,f),T&&d&&t(u).parent().append(d))}else f=a(g.slice(0,v+1).join(p),r),l(u,f);return!0}function i(t,e){return t.innerHeight()>e.maxHeight}function a(e,n){for(;t.inArray(e.slice(-1),n.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),n.lastCharacter.noEllipsis)<0&&(e+=n.ellipsis),e}function d(t){return{width:t.innerWidth(),height:t.innerHeight()}}function l(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function s(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function u(t){do t=t.previousSibling;while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function c(e,n,o){var r,i=e&&e[0];if(i){if(!o){if(3===i.nodeType)return i;if(t.trim(e.text()))return c(e.contents().last(),n)}for(r=u(i);!r;){if(e=e.parent(),e.is(n)||!e.length)return!1;r=u(e[0])}if(r)return c(t(r),n)}return!1}function f(e,n){return e?"string"==typeof e?(e=t(e,n),e.length?e:!1):e.jquery?e:!1:!1}function h(t){for(var e=t.innerHeight(),n=["paddingTop","paddingBottom"],o=0,r=n.length;r>o;o++){var i=parseInt(t.css(n[o]),10);isNaN(i)&&(i=0),e-=i}return e}function p(t,e){return t?(e="string"==typeof e?"dotdotdot: "+e:["dotdotdot:",e],"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(e),!1):!1}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return e&&e.debug===!1||p(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var r=this;r.data("dotdotdot")&&r.trigger("destroy.dot"),r.data("dotdotdot-style",r.attr("style")||""),r.css("word-wrap","break-word"),"nowrap"===r.css("white-space")&&r.css("white-space","normal"),r.bind_events=function(){return r.bind("update.dot",function(e,d){e.preventDefault(),e.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:h(r),l.maxHeight+=l.tolerance,"undefined"!=typeof d&&(("string"==typeof d||d instanceof HTMLElement)&&(d=t("<div />").append(d).contents()),d instanceof t&&(a=d)),v=r.wrapInner('<div class="dotdotdot" />').children(),v.empty().append(a.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var u=!1,c=!1;return s.afterElement&&(u=s.afterElement.clone(!0),u.show(),s.afterElement.remove()),i(v,l)&&(c="children"==l.wrap?n(v,l,u):o(v,r,v,l,u)),v.replaceWith(v.contents()),v=null,t.isFunction(l.callback)&&l.callback.call(r[0],c,a),s.isTruncated=c,c}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(r[0],s.isTruncated),s.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(r[0],a),a}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),r.unwatch().unbind_events().empty().append(a).attr("style",r.data("dotdotdot-style")||"").data("dotdotdot",!1)}),r},r.unbind_events=function(){return r.unbind(".dot"),r},r.watch=function(){if(r.unwatch(),"window"==l.watch){var e=t(window),n=e.width(),o=e.height();e.bind("resize.dot"+s.dotId,function(){n==e.width()&&o==e.height()&&l.windowResizeFix||(n=e.width(),o=e.height(),c&&clearInterval(c),c=setTimeout(function(){r.trigger("update.dot")},10))})}else u=d(r),c=setInterval(function(){var t=d(r);(u.width!=t.width||u.height!=t.height)&&(r.trigger("update.dot"),u=d(r))},100);return r},r.unwatch=function(){return t(window).unbind("resize.dot"+s.dotId),c&&clearInterval(c),r};var a=r.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,e),s={},u={},c=null,v=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),s.afterElement=f(l.after,r),s.isTruncated=!1,s.dotId=g++,r.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&r.watch(),r},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}};var g=1,v=t.fn.html;t.fn.html=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?this.trigger("update",[n]):v.apply(this,arguments)};var w=t.fn.text;t.fn.text=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?(n=t("<div />").text(n).html(),this.trigger("update",[n])):w.apply(this,arguments)}}}(jQuery);